{% comment %}
Wishlist header icon block

IMPORTANT CHANGE:
- No hard-hide anymore.
- If not paid/active: show but disable.
- Load wishlist.js only once + defer.
{% endcomment %}

<style>
  /* Always show wishlist UI */
  .wishlist-ui { display: block !important; }

  /* If not paid/active: show but disable */
  html:not(.wishlist-paid) .wishlist-ui{
    opacity: .45;
    pointer-events: none;
    filter: grayscale(1);
  }
</style>

<script>
  window.wishlistCustomerId = {{ customer.id | json }};
</script>

<div class="wishlist-ui wishlist-ui--header">
  <a class="wl-nav" href="/pages/wishlist" data-wl-nav>
    <span class="wl-ico" aria-hidden="true">‚ù§</span>
    <span class="wl-label">Wishlist</span>
    <span class="wl-badge" data-wl-count style="display:none">0</span>
  </a>
</div>

<style>
  .wl-nav{
    display:inline-flex;
    align-items:center;
    gap:8px;
    text-decoration:none;
    color:inherit;
    font-weight:700;
    position:relative;
    white-space:nowrap;
  }
  .wl-ico{
    color:#ff2ea1;
    font-size:18px;
    line-height:1;
  }
  .wl-badge{
    position:absolute;
    top:-8px;
    left:12px;
    min-width:18px;
    height:18px;
    padding:0 5px;
    border-radius:999px;
    background:#000;
    color:#fff;
    font-size:12px;
    display:flex;
    align-items:center;
    justify-content:center;
  }
</style>

{% comment %}
Load wishlist.js only if the embed hasn't already loaded it.
Use defer to avoid parser-blocking warning.
{% endcomment %}
<script>
  (function(){
    var alreadyLoaded =
      (typeof window.WishlistUI !== "undefined") ||
      document.querySelector('script[data-wl-script="1"]');

    if (alreadyLoaded) return;

    var s = document.createElement("script");
    s.src = {{ 'wishlist.js' | asset_url | json }};
    s.defer = true;
    s.setAttribute("data-wl-script","1");
    document.head.appendChild(s);
  })();
</script>

{% schema %}
{
  "name": "Wishlist Header Icon",
  "target": "section",
  "settings": []
}
{% endschema %}
